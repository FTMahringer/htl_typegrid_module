<?php

declare(strict_types=1);

use Drupal\field\Entity\FieldStorageConfig;
use Drupal\image\Entity\ImageStyle;


/**
 * @file
 * Registriert Twig-Template für den Grid-Block.
 */


function htl_typegrid_theme(array $existing, $type, $theme, $path): array {
  return [
    'htl_grid_block' => [
      'template' => 'htl-grid-block',
      'path' => $path . '/templates',
      'variables' => [
        'bundles_data' => [],
        'cards' => [],
        'columns' => 3,
        'rows' => 2,

        'filters' => ['sort_mode' => 'created', 'alpha_field' => 'title', 'direction' => 'DESC'],
        'config' => NULL,
      ],
    ],
    'htl_grid_pinned_block' => [
      'template' => 'htl-grid-pinned-block',
      'path' => $path . '/templates',
      'variables' => [
        'cards' => [],
        'columns' => 3,
        'rows' => 1,
        'config' => NULL,
      ],
    ],
  ];
}



/**
 * Allowed values für das Bildstil-Dropdown.
 *
 * Wird in FieldStorageConfig als 'allowed_values_function' verwendet.
 *
 * @param \Drupal\field\Entity\FieldStorageConfig $definition
 * @param \Drupal\field\Entity\FieldConfig|null $instance
 * @param bool|null $cacheable
 *
 * @return array
 *   Key => Label.
 */
function htl_typegrid_image_style_allowed_values(FieldStorageConfig $definition, $instance = NULL, &$cacheable = NULL): array {
  $values = [];

  // Default option - uses grid's default style.
  $values['default'] = t('- Default -');

  // All image styles from Drupal.
  $styles = ImageStyle::loadMultiple();
  foreach ($styles as $id => $style) {
    $values[$id] = $style->label();
  }

  return $values;
}
